# Deployment Update Guide
## How to Update Your Render Deployment

### 🚀 Quick Update (Using Script)

```bash
cd /home/prince-verma/medical_management
./update_deployment.sh
```

This script will automatically:
- ✅ Run pre-deployment tests
- ✅ Check for uncommitted changes
- ✅ Run Django system checks
- ✅ Collect static files
- ✅ Test database migrations
- ✅ Push changes to GitHub
- ✅ Provide next steps for Render

### 🛠️ Manual Update Steps

#### Step 1: Prepare Your Local Environment
```bash
cd /home/prince-verma/medical_management
source venv/bin/activate
```

#### Step 2: Test Your Changes Locally
```bash
# Run deployment tests
python test_deployment.py

# Run Django checks
python manage.py check --deploy

# Test migrations
python manage.py makemigrations --dry-run
python manage.py migrate --plan

# Collect static files
python manage.py collectstatic --noinput
```

#### Step 3: Commit and Push Changes
```bash
# Check what's changed
git status

# Add all changes
git add .

# Commit with a meaningful message
git commit -m "Your update description here"

# Push to GitHub
git push origin main
```

#### Step 4: Deploy on Render

1. **Go to Render Dashboard**
   - Visit: https://dashboard.render.com
   - Log in to your account

2. **Find Your Service**
   - Look for `medical-management-system`
   - Click on the service name

3. **Trigger Deployment**
   - Click on the **"Deployments"** tab
   - Click **"Deploy Latest Commit"** button
   - Wait for deployment to complete (3-5 minutes)

4. **Monitor Deployment**
   - Watch the deployment logs
   - Look for any error messages
   - Wait for "Deploy succeeded" message

#### Step 5: Verify Deployment
- Visit: https://medical-management-system-v8d5.onrender.com
- Check that your updates are working
- Test admin panel: https://medical-management-system-v8d5.onrender.com/admin/

### 🔧 Environment Variables

Make sure these are set in your Render dashboard:

| Variable | Value |
|----------|-------|
| `ALLOWED_HOSTS` | `medical-management-system-v8d5.onrender.com,localhost,127.0.0.1` |
| `DEBUG` | `False` |
| `EMAIL_HOST_PASSWORD` | `kgbknhjbemonukgm` |
| `SECRET_KEY` | (Auto-generated by Render) |

### 📋 Common Update Scenarios

#### 🎨 **Frontend Updates (Templates/Static Files)**
```bash
# After making changes to templates or CSS/JS
python manage.py collectstatic --noinput
git add .
git commit -m "Update frontend styling/templates"
git push origin main
```

#### 🗄️ **Database Model Updates**
```bash
# After changing models.py files
python manage.py makemigrations
python manage.py migrate
git add .
git commit -m "Update database models"
git push origin main
```

#### ⚙️ **Settings/Configuration Updates**
```bash
# After changing settings.py or adding new apps
python manage.py check --deploy
git add .
git commit -m "Update application settings"
git push origin main
```

#### 🔒 **Security Updates**
```bash
# After updating requirements.txt or security settings
pip install -r requirements.txt
python manage.py check --deploy
git add .
git commit -m "Security updates and dependency upgrades"
git push origin main
```

### 🚨 Troubleshooting Deployment Issues

#### **Build Failed**
1. Check Render deployment logs
2. Look for Python/Django errors
3. Verify `requirements.txt` is correct
4. Check `build.sh` script

#### **Application Won't Start**
1. Check for migration issues
2. Verify environment variables are set
3. Look for import errors in logs
4. Check `ALLOWED_HOSTS` setting

#### **Static Files Not Loading**
1. Ensure `collectstatic` ran successfully
2. Check `STATIC_URL` and `STATIC_ROOT` settings
3. Verify WhiteNoise middleware is configured

#### **Database Issues**
1. Check if migrations need to be run
2. Verify DATABASE_URL is set correctly
3. Look for PostgreSQL connection errors

### 📊 Deployment Monitoring

#### **Check Deployment Status**
- Go to Render dashboard
- Click on your service
- Check "Deployments" tab for status

#### **View Logs**
- In Render dashboard, click "Logs" tab
- Look for errors or warnings
- Monitor application startup

#### **Health Checks**
```bash
# Test if site is responding
curl -I https://medical-management-system-v8d5.onrender.com

# Check admin panel
curl -I https://medical-management-system-v8d5.onrender.com/admin/
```

### 🔄 Rollback Strategy

If deployment fails or has issues:

1. **Quick Rollback in Render**
   - Go to "Deployments" tab
   - Find a previous working deployment
   - Click "Redeploy" on that version

2. **Fix and Redeploy**
   - Identify the issue in logs
   - Fix the code locally
   - Test thoroughly
   - Follow update process again

### 📝 Best Practices

1. **Always test locally first**
   ```bash
   python manage.py runserver
   # Test your changes at http://127.0.0.1:8000
   ```

2. **Use meaningful commit messages**
   ```bash
   git commit -m "Add patient search functionality"
   git commit -m "Fix email validation bug"
   git commit -m "Update dashboard styling"
   ```

3. **Check deployment logs**
   - Always monitor logs after deployment
   - Look for warnings or errors
   - Verify all services are running

4. **Test critical features after deployment**
   - Login/logout functionality
   - User registration
   - Admin panel access
   - Key application features

### 📞 Support Information

- **Your Repository:** https://github.com/Prince12222211/Medical-Management-System
- **Production URL:** https://medical-management-system-v8d5.onrender.com
- **Admin Panel:** https://medical-management-system-v8d5.onrender.com/admin/
- **Render Dashboard:** https://dashboard.render.com

---

**Remember:** Render automatically rebuilds and deploys when you push to your main branch, but you can also trigger manual deployments from the dashboard.
